.. _ensemble_analysis:

EnsembleAnalysis
==========================

This module analyzes ensembles in terms of intermediate order. In this module, ensembles have internal variable names (identifiers).

``addpdb``
---------------------------------

Input of template conformers from PDB files. 

.. code-block:: matlab

    addpdb file identifier

Arguments
    *   ``file`` - file name, can contain wildcards
    *   ``identifier`` - module-internal identifier for the ensemble, e.g. 'ensemble_1'
Remarks
    *   use wildcard '*' for part of the filename to process all conformers from a previous step in the pipeline 
    *   individual PDB files can contain a single model or several models; this can be freely mixed
	
``getens``
---------------------------------

Input of template conformers from PDB files specified by an MMMx ensemble list. 

.. code-block:: matlab

    gentens file identifier

Arguments
    *   ``file`` - name of an MMMx ensemble file list (extension '.ens')
    *   ``identifier`` - module-internal identifier for the ensemble, e.g. 'ensemble_2'
Remarks
    *   best way of analyzing an ensemble generated by the EnsembleFit module 

``subsample``
---------------------------------

Subsample an ensemble to a smaller ensemble. 

.. code-block:: matlab

    subsample ratio input output

Arguments
    *   ``ratio`` - integer reduction factor for ensemble size
    *   ``input`` - identifier of the input ensemble
    *   ``output`` - identifier of the output (reduced) ensemble
Remarks
    *   this is particularly useful for molecular dynamics trajectories

``figures``
---------------------------------

Subsample an ensemble to a smaller ensemble. 

.. code-block:: matlab

    figures format

Arguments
    *   ``format`` - one of the formats in which Matlab can save figures, e.g. 'pdf', default is 'pdf'
Remarks
    *   figure saving is on by default in this module, use format 'off' to switch it off


``sort``
---------------------------------

Iterative hierarchical clustering and sorting of an ensemble. 

.. code-block:: matlab

    sort filename input [option]

Arguments
    *   ``filename`` - name of the output ensemble list, extension should be '.ens'
    *   ``input`` - identifier of the input ensemble
    *   ``option`` - option 'oriented' assumes that the conformers are already in the same frame, otherwise they are optimally superimposed
    *   ``option`` - option 'drms' uses orientation-independent distance root-mean square as a metric
Remarks
    *   the algorithm attempts to group similar conformers and to start from the most typical conformers

``measures``
---------------------------------

Compute various measures of the ensemble. This is a block key with `n` lines for `n` measures. 

.. code-block:: matlab

    measures filename  input [range]
       subkey
       ...
    .measures

Arguments
    *   ``filename`` - basis name for the output files, abbreviated below as '%s'
    *   ``input`` - identifier for the input ensemble
    *   ``range`` - optional MMMx address that specifies only a range of a conformer for analysis, e.g. `(A)187-320`
    *   ``measure`` - a subkey that specifies a measure from the following list
Available subkeys
    *   ``matlab`` - save output data to Matlab files
	*   ``csv`` - save output data to comma-separated value files
    *   ``oriented`` - assume that conformers are already oriented, default is false (conformers are superimposed)
    *   ``Rg`` - radius of gyration. including standard deviation (output to logfile)
    *   ``width`` - ensemble width and density in Angstroem (output to logfile), also computes pair r.m.s.d. matrix and central conformer
    *   ``correlation`` - correlation matrix, output as figure and to files 'residue\_pair\_correlation_%s' with extensions '.csv'and '.mat'
    *   ``sort`` - sort for computation of correlation matrix
	*   ``drms`` - uses distance root mean square deviation for correlation matrix and sorting
    *   ``compactness`` - compactness matrix    
Remarks
    *   saving output to both Matlab ('.mat') and '.csv' files is allowed 
	*   if neither the ``matlab`` nor the ``csv`` subkey is present, output is only to figures or logfile
    *   ``oriented`` affects only computation of pair r.m.s.d. (correlation matrix) 
	
``flexibility``
---------------------------------

Computes local flexibility profiles of peptide or nucleotide chains 

.. code-block:: matlab

    flexibility filename input

Arguments
    *   ``filename`` - name of the output file
    *   ``input`` - identifier of the input ensemble
Remarks
    *   the algorithm analyzes variation of backbone dihedrals `\psi` and `\phi`
    *   for RNA, pseudo-torsion angles are analyzed
    *   local flexibility ranges between 0 (rigid) and 1 (random)

``order``
---------------------------------

Computes local order profiles of peptide or nucleotide chains 

.. code-block:: matlab

    order filename input

Arguments
    *   ``filename`` - name of the output file
    *   ``input`` - identifier of the input ensemble
Remarks
    *   the algorithm is based on an adapttation of Flory's  characteristic ratio to polymers with secondary structure
    *   the local order parameter ranges between 0 (random) and 1 (perfect order)
    *   the local order parameter is somewhat longer ranged than the flexibility parameter mentioned above

``density``
---------------------------------

Computes a 3D density map (pseudo-electron density) of an ensemble 

.. code-block:: matlab

    density filename input [range [resolution]]

Arguments
    *   ``filename`` - name of the output file, specify with extension '.mrc'
    *   ``input`` - identifier of the input ensemble
    *   ``range`` - optional MMMx address that specifies only a range of a conformer for analysis, e.g. `(A)187-320`
    *   ``resolution`` - resolution in Angstroem (optional), defaults to 1
Remarks
    *   output is as a '.mrc' file, which can be visualized by most protein graphics programs
    *   a larger value for resolution leads to faster computation and a smaller file and may still be adequate for strong disorder
	
``superimpose``
---------------------------------

Superposition of conformers in an ensemble 

.. code-block:: matlab

    superimpose output input [range [template [template_range [mode]]]]

Arguments
    *   ``output`` - name of the output file, extension '.pdb' is appended, if none
    *   ``input`` - identifier of the input ensemble
    *   ``range`` - optional MMMx address that specifies only a range of a conformer for analysis, e.g. `(A)187-320`
    *   ``template`` - template ensemble or structure (optional)
    *   ``template_range`` - optional MMMx address that specifies a template range of a conformer, e.g. `(B)187-320`
    *   ``mode`` - optional string mode can be 'central' to request superposition onto the central conformer
Remarks
    *   by default, superposition is to the first conformer of the input ensemble if no range is provided
    *   if a template and central are specified, superposition is to central conformer of a superensemble consisting of input and template
    *   the range argument '(*)' selects the complete structure
	
``save``
---------------------------------

Save ensemble to a single PDB file  

.. code-block:: matlab

    save output ensemble_id

Arguments
    *   ``output`` - name of the output file, extension '.pdb' is appended, if none
    *   ``ensemble_id`` - identifier of the ensemble to be save
Remarks
    *   populations are stored in a REMARK 400 field
  
``compare``
---------------------------------

Comparison of two ensembles 

.. code-block:: matlab

    compare ensemble_1 ensemble_2 [range [mode]]

Arguments
    *   ``ensemble_1`` - identifier of the first ensemble
    *   ``ensemble_2`` - identifier of the second ensemble
    *   ``range`` - optional MMMx address that specifies only a range of a conformer for comparison, e.g. `(A)187-320`
    *   ``mode`` - optional string mode can be 'resolved' to request residue-wise comparison
Remarks
    *   the algorithm computes overlap of pseudo-electron densities between ensembles
    *   the range argument '(*)' selects the complete structure
    *   the two ensembles may have different numbers of conformers
    *   residue-wise comparison of large ensembles can take very long
  	